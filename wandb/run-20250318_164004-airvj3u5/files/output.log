/home/zzs/miniconda3/envs/unitraj/lib/python3.9/site-packages/hydra/_internal/defaults_list.py:251: UserWarning: In 'config': Defaults list is missing `_self_`. See https://hydra.cc/docs/1.2/upgrades/1.0_to_1.1/default_composition_order for more information
  warnings.warn(msg, UserWarning)
Seed set to 42
Loading training data...
Warning: cache path /home/zzs/zzs/UniTraj/cache/nuscenes_mini_train_split/dataset_split already exists, skip
Loaded 742 samples from /home/zzs/zzs/UniTraj/dataset_split/nuscenes_mini_train_split
Data loaded
Loading validation data...
Warning: cache path /home/zzs/zzs/UniTraj/cache/nuscenes_mini_test_split/dataset_split already exists, skip
Loaded 61 samples from /home/zzs/zzs/UniTraj/dataset_split/nuscenes_mini_test_split
Data loaded
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/1
----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All distributed processes registered. Starting with 1 processes
----------------------------------------------------------------------------------------------------

/home/zzs/miniconda3/envs/unitraj/lib/python3.9/site-packages/pytorch_lightning/loggers/wandb.py:397: There is a wandb run already in progress and newly created instances of `WandbLogger` will reuse this run. If this is not desired, call `wandb.finish()` before instantiating `WandbLogger`.
Restoring states from the checkpoint path at /home/zzs/zzs/unitraj_ckpt/3.18.1/epoch=39-val/brier_fde=5.23.ckpt
/home/zzs/miniconda3/envs/unitraj/lib/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:362: The dirpath has changed from '/home/zzs/zzs/unitraj_ckpt/3.18.1' to '/home/zzs/zzs/unitraj_ckpt/20250318-164006_3.18.3_nuscenes_mini_MTR', therefore `best_model_score`, `kth_best_model_path`, `kth_value`, `last_model_path` and `best_k_models` won't be reloaded. Only `best_model_path` will be reloaded.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
Adjusting learning rate of group 0 to 1.0000e-04.

  | Name            | Type       | Params | Mode
-------------------------------------------------------
0 | context_encoder | MTREncoder | 5.1 M  | train
1 | motion_decoder  | MTRDecoder | 60.1 M | train
-------------------------------------------------------
65.2 M    Trainable params
0         Non-trainable params
65.2 M    Total params
260.966   Total estimated model params size (MB)
583       Modules in train mode
0         Modules in eval mode
Restored all states from the checkpoint at /home/zzs/zzs/unitraj_ckpt/3.18.1/epoch=39-val/brier_fde=5.23.ckpt
                                                                                                                                                                                                                                  
/home/zzs/miniconda3/envs/unitraj/lib/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=19` in the `DataLoader` to improve performance.
/home/zzs/miniconda3/envs/unitraj/lib/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=19` in the `DataLoader` to improve performance.
`Trainer.fit` stopped: `max_epochs=40` reached.
FIT Profiler Report

----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|  Action                                                                                                                                                                    	|  Mean duration (s)	|  Num calls      	|  Total time (s) 	|  Percentage %   	|
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|  Total                                                                                                                                                                     	|  -              	|  75             	|  9.9089         	|  100 %          	|
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|  [Strategy]DDPStrategy.validation_step                                                                                                                                     	|  0.3693         	|  2              	|  0.7386         	|  7.454          	|
|  [_EvaluationLoop].val_next                                                                                                                                                	|  0.028506       	|  2              	|  0.057012       	|  0.57537        	|
|  [Callback]ModelSummary.on_fit_start                                                                                                                                       	|  0.010652       	|  1              	|  0.010652       	|  0.1075         	|
|  [Strategy]DDPStrategy.batch_to_device                                                                                                                                     	|  0.0046511      	|  2              	|  0.0093021      	|  0.093877       	|
|  [LightningModule]MotionTransformer.transfer_batch_to_device                                                                                                               	|  0.0045354      	|  2              	|  0.0090709      	|  0.091543       	|
|  [LightningModule]MotionTransformer.on_validation_model_eval                                                                                                               	|  0.0024942      	|  1              	|  0.0024942      	|  0.025171       	|
|  [LightningModule]MotionTransformer.configure_optimizers                                                                                                                   	|  0.0016751      	|  1              	|  0.0016751      	|  0.016905       	|
|  [Callback]TQDMProgressBar.on_sanity_check_start                                                                                                                           	|  0.0014764      	|  1              	|  0.0014764      	|  0.0149         	|
|  [Callback]TQDMProgressBar.on_validation_batch_start                                                                                                                       	|  0.00041906     	|  2              	|  0.00083812     	|  0.0084583      	|
|  [Callback]TQDMProgressBar.on_validation_end                                                                                                                               	|  0.00068819     	|  1              	|  0.00068819     	|  0.0069452      	|
|  [Callback]ModelCheckpoint{'monitor': 'val/brier_fde', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.setup                    	|  0.00064153     	|  1              	|  0.00064153     	|  0.0064743      	|
|  [Callback]TQDMProgressBar.on_validation_batch_end                                                                                                                         	|  0.00022825     	|  2              	|  0.0004565      	|  0.004607       	|
|  [LightningModule]MotionTransformer.on_validation_epoch_end                                                                                                                	|  7.851e-05      	|  1              	|  7.851e-05      	|  0.00079232     	|
|  [Callback]ModelCheckpoint{'monitor': 'val/brier_fde', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_end        	|  1.79e-05       	|  1              	|  1.79e-05       	|  0.00018065     	|
|  [Callback]TQDMProgressBar.on_validation_start                                                                                                                             	|  1.4679e-05     	|  1              	|  1.4679e-05     	|  0.00014814     	|
|  [Callback]TQDMProgressBar.on_sanity_check_end                                                                                                                             	|  1.461e-05      	|  1              	|  1.461e-05      	|  0.00014744     	|
|  [Callback]TQDMProgressBar.on_load_checkpoint                                                                                                                              	|  9.999e-06      	|  1              	|  9.999e-06      	|  0.00010091     	|
|  [Strategy]DDPStrategy.on_validation_start                                                                                                                                 	|  9.424e-06      	|  1              	|  9.424e-06      	|  9.5107e-05     	|
|  [Callback]TQDMProgressBar.setup                                                                                                                                           	|  9.05e-06       	|  1              	|  9.05e-06       	|  9.1332e-05     	|
|  [LightningModule]MotionTransformer.on_before_batch_transfer                                                                                                               	|  4.307e-06      	|  2              	|  8.614e-06      	|  8.6932e-05     	|
|  [Callback]ModelSummary.on_validation_batch_end                                                                                                                            	|  3.2235e-06     	|  2              	|  6.447e-06      	|  6.5063e-05     	|
|  [Callback]ModelSummary.on_validation_batch_start                                                                                                                          	|  3.018e-06      	|  2              	|  6.036e-06      	|  6.0915e-05     	|
|  [Callback]TQDMProgressBar.on_fit_end                                                                                                                                      	|  5.534e-06      	|  1              	|  5.534e-06      	|  5.5849e-05     	|
|  [Callback]ModelSummary.on_validation_end                                                                                                                                  	|  4.497e-06      	|  1              	|  4.497e-06      	|  4.5384e-05     	|
|  [LightningModule]MotionTransformer.configure_callbacks                                                                                                                    	|  4.386e-06      	|  1              	|  4.386e-06      	|  4.4263e-05     	|
|  [Callback]ModelSummary.on_sanity_check_start                                                                                                                              	|  4.383e-06      	|  1              	|  4.383e-06      	|  4.4233e-05     	|
|  [LightningModule]MotionTransformer.on_load_checkpoint                                                                                                                     	|  4.101e-06      	|  1              	|  4.101e-06      	|  4.1387e-05     	|
|  [Callback]ModelCheckpoint{'monitor': 'val/brier_fde', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_batch_start	|  2.001e-06      	|  2              	|  4.002e-06      	|  4.0388e-05     	|
|  [Callback]TQDMProgressBar.on_fit_start                                                                                                                                    	|  3.709e-06      	|  1              	|  3.709e-06      	|  3.7431e-05     	|
|  [Callback]ModelSummary.on_validation_start                                                                                                                                	|  3.601e-06      	|  1              	|  3.601e-06      	|  3.6341e-05     	|
|  [Strategy]DDPStrategy.on_validation_end                                                                                                                                   	|  3.291e-06      	|  1              	|  3.291e-06      	|  3.3213e-05     	|
|  [Callback]ModelCheckpoint{'monitor': 'val/brier_fde', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_fit_start             	|  3.267e-06      	|  1              	|  3.267e-06      	|  3.297e-05      	|
|  [LightningModule]MotionTransformer.on_validation_batch_start                                                                                                              	|  1.5335e-06     	|  2              	|  3.067e-06      	|  3.0952e-05     	|
|  [LightningModule]MotionTransformer.on_validation_batch_end                                                                                                                	|  1.518e-06      	|  2              	|  3.036e-06      	|  3.0639e-05     	|
|  [Callback]ModelCheckpoint{'monitor': 'val/brier_fde', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_batch_end  	|  1.4455e-06     	|  2              	|  2.891e-06      	|  2.9176e-05     	|
|  [LightningModule]MotionTransformer.on_validation_epoch_start                                                                                                              	|  2.784e-06      	|  1              	|  2.784e-06      	|  2.8096e-05     	|
|  [LightningModule]MotionTransformer.on_fit_end                                                                                                                             	|  2.692e-06      	|  1              	|  2.692e-06      	|  2.7168e-05     	|
|  [LightningModule]MotionTransformer.on_after_batch_transfer                                                                                                                	|  1.3335e-06     	|  2              	|  2.667e-06      	|  2.6915e-05     	|
|  [LightningModule]MotionTransformer.on_fit_start                                                                                                                           	|  2.067e-06      	|  1              	|  2.067e-06      	|  2.086e-05      	|
|  [Callback]TQDMProgressBar.teardown                                                                                                                                        	|  2.046e-06      	|  1              	|  2.046e-06      	|  2.0648e-05     	|
|  [Callback]ModelSummary.on_sanity_check_end                                                                                                                                	|  1.949e-06      	|  1              	|  1.949e-06      	|  1.9669e-05     	|
|  [LightningModule]MotionTransformer.teardown                                                                                                                               	|  1.844e-06      	|  1              	|  1.844e-06      	|  1.861e-05      	|
|  [Callback]ModelSummary.setup                                                                                                                                              	|  1.829e-06      	|  1              	|  1.829e-06      	|  1.8458e-05     	|
|  [Callback]ModelSummary.on_load_checkpoint                                                                                                                                 	|  1.798e-06      	|  1              	|  1.798e-06      	|  1.8145e-05     	|
|  [Callback]TQDMProgressBar.on_validation_epoch_end                                                                                                                         	|  1.759e-06      	|  1              	|  1.759e-06      	|  1.7752e-05     	|
|  [Callback]ModelCheckpoint{'monitor': 'val/brier_fde', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_load_checkpoint       	|  1.735e-06      	|  1              	|  1.735e-06      	|  1.751e-05      	|
|  [LightningModule]MotionTransformer.setup                                                                                                                                  	|  1.672e-06      	|  1              	|  1.672e-06      	|  1.6874e-05     	|
|  [Callback]ModelCheckpoint{'monitor': 'val/brier_fde', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_start      	|  1.58e-06       	|  1              	|  1.58e-06       	|  1.5945e-05     	|
|  [LightningModule]MotionTransformer.on_validation_end                                                                                                                      	|  1.468e-06      	|  1              	|  1.468e-06      	|  1.4815e-05     	|
|  [Callback]TQDMProgressBar.on_validation_epoch_start                                                                                                                       	|  1.431e-06      	|  1              	|  1.431e-06      	|  1.4442e-05     	|
|  [Callback]ModelSummary.on_fit_end                                                                                                                                         	|  1.34e-06       	|  1              	|  1.34e-06       	|  1.3523e-05     	|
|  [Callback]ModelCheckpoint{'monitor': 'val/brier_fde', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_sanity_check_start    	|  1.205e-06      	|  1              	|  1.205e-06      	|  1.2161e-05     	|
|  [LightningModule]MotionTransformer.on_validation_start                                                                                                                    	|  1.18e-06       	|  1              	|  1.18e-06       	|  1.1909e-05     	|
|  [Callback]ModelCheckpoint{'monitor': 'val/brier_fde', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_epoch_start	|  1.143e-06      	|  1              	|  1.143e-06      	|  1.1535e-05     	|
|  [Callback]ModelCheckpoint{'monitor': 'val/brier_fde', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.teardown                 	|  1.125e-06      	|  1              	|  1.125e-06      	|  1.1353e-05     	|
|  [Callback]ModelSummary.on_validation_epoch_start                                                                                                                          	|  1.109e-06      	|  1              	|  1.109e-06      	|  1.1192e-05     	|
|  [Callback]ModelCheckpoint{'monitor': 'val/brier_fde', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_epoch_end  	|  1.025e-06      	|  1              	|  1.025e-06      	|  1.0344e-05     	|
|  [Callback]ModelSummary.teardown                                                                                                                                           	|  1.01e-06       	|  1              	|  1.01e-06       	|  1.0193e-05     	|
|  [Callback]ModelCheckpoint{'monitor': 'val/brier_fde', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_fit_end               	|  9.76e-07       	|  1              	|  9.76e-07       	|  9.8498e-06     	|
|  [Callback]ModelCheckpoint{'monitor': 'val/brier_fde', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_sanity_check_end      	|  9.61e-07       	|  1              	|  9.61e-07       	|  9.6984e-06     	|
|  [Callback]ModelSummary.on_validation_epoch_end                                                                                                                            	|  9.31e-07       	|  1              	|  9.31e-07       	|  9.3956e-06     	|
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
